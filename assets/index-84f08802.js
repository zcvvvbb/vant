import{u as U}from"./use-expose-80cfd2b2.js";import{A as E,y as u,u as I,M as L,q as $,e as n,r as A,o as D,a as F,w as d,C as t,g as w,t as P,F as W,d as M}from"./vue-libs-19c20d28.js";import{c as k,t as q,a as H,b as j,w as G}from"./with-install-560d59bf.js";import{c as J,a as K,U as O}from"./use-translate-71d4880c.js";import{V as S}from"./index-2ad848b9.js";import{V as N}from"./index-947c278b.js";import"./use-route-751feeeb.js";import"./index-1ef61aa2.js";import"./index-8bc2514f.js";import"./index-2b75ebd8.js";import"./constant-ee6e27d7.js";const Q={top:k(10),rows:k(4),duration:k(4e3),autoPlay:q,delay:H(300),modelValue:j()},[R,C]=J("barrage"),X=E({name:R,props:Q,emits:["update:modelValue"],setup(s,{emit:o,slots:y}){const m=u(),V=C("item"),f=u(0),r=[],B=(e,p=s.delay)=>{const l=document.createElement("span");return l.className=V,l.innerText=String(e),l.style.animationDuration=`${s.duration}ms`,l.style.animationDelay=`${p}ms`,l.style.animationName="van-barrage",l.style.animationTimingFunction="linear",l},c=u(!0),v=u(s.autoPlay),b=({id:e,text:p},l)=>{var h;const a=B(p,c.value?l*s.delay:void 0);!s.autoPlay&&v.value===!1&&(a.style.animationPlayState="paused"),(h=m.value)==null||h.append(a),f.value++;const g=(f.value-1)%+s.rows*a.offsetHeight+ +s.top;a.style.top=`${g}px`,a.dataset.id=String(e),r.push(a),a.addEventListener("animationend",()=>{o("update:modelValue",[...s.modelValue].filter(T=>String(T.id)!==a.dataset.id))})},i=(e,p)=>{const l=new Map(p.map(a=>[a.id,a]));e.forEach((a,g)=>{l.has(a.id)?l.delete(a.id):b(a,g)}),l.forEach(a=>{const g=r.findIndex(h=>h.dataset.id===String(a.id));g>-1&&(r[g].remove(),r.splice(g,1))}),c.value=!1};I(()=>s.modelValue.slice(),(e,p)=>i(e??[],p??[]),{deep:!0});const _=u({});return L(async()=>{var e;_.value["--move-distance"]=`-${(e=m.value)==null?void 0:e.offsetWidth}px`,await $(),i(s.modelValue,[])}),U({play:()=>{v.value=!0,r.forEach(e=>{e.style.animationPlayState="running"})},pause:()=>{v.value=!1,r.forEach(e=>{e.style.animationPlayState="paused"})}}),()=>{var e;return n("div",{class:C(),ref:m,style:_.value},[(e=y.default)==null?void 0:e.call(y)])}}}),Y=G(X),z=Y,Z=M("div",{class:"video"},null,-1),ee=M("div",{class:"video"},null,-1),pe=E({__name:"index",setup(s){const o=K({"zh-CN":{barrage:"弹幕",play:"开始",pause:"暂停",videoBarrage:"模仿视频弹幕",lightweight:"轻量",customizable:"可定制的",mobile:"移动端",library:"组件库"},"en-US":{barrage:"barrage",play:"play",pause:"pause",videoBarrage:"Imitate video barrage",lightweight:"Lightweight",customizable:"Customizable",mobile:"Mobile",library:"Library"}}),y=[{id:100,text:o("lightweight")},{id:101,text:o("customizable")},{id:102,text:o("mobile")},{id:103,text:"Vue"},{id:104,text:o("library")},{id:105,text:"VantUI"},{id:106,text:"666"}],m=u([...y]),V=()=>{m.value.push({id:Math.random(),text:"Barrage"})},f=u([...y]),r=u(),B=()=>{f.value.push({id:Math.random(),text:"Barrage"})},[c,v]=O(!1);return I(c,()=>{var b,i;c.value?(b=r.value)==null||b.play():(i=r.value)==null||i.pause()}),(b,i)=>{const _=A("demo-block");return D(),F(W,null,[n(_,{title:t(o)("basicUsage")},{default:d(()=>[n(t(z),{modelValue:m.value,"onUpdate:modelValue":i[0]||(i[0]=x=>m.value=x)},{default:d(()=>[Z]),_:1},8,["modelValue"]),n(t(N),{style:{"margin-top":"10px"}},{default:d(()=>[n(t(S),{onClick:V,type:"primary",size:"small"},{default:d(()=>[w(P(t(o)("barrage")),1)]),_:1})]),_:1})]),_:1},8,["title"]),n(_,{title:t(o)("videoBarrage")},{default:d(()=>[n(t(z),{modelValue:f.value,"onUpdate:modelValue":i[1]||(i[1]=x=>f.value=x),ref_key:"videoBarrage",ref:r,"auto-play":!1},{default:d(()=>[ee]),_:1},8,["modelValue"]),n(t(N),{style:{"margin-top":"10px"}},{default:d(()=>[n(t(S),{onClick:B,type:"primary",size:"small",disabled:!t(c)},{default:d(()=>[w(P(t(o)("barrage")),1)]),_:1},8,["disabled"]),n(t(S),{onClick:i[2]||(i[2]=x=>t(v)()),size:"small"},{default:d(()=>[w(P(t(c)?t(o)("pause"):t(o)("play")),1)]),_:1})]),_:1})]),_:1},8,["title"])],64)}}});export{pe as default};
