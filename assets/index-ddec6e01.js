import{A as L,y as w,D as R,u as K,q as j,M as F,J as _,L as G,P as V,e as s,S as H,F as M,T as N,j as $,v as q,B as J}from"./vue-libs-19c20d28.js";import{n as O,t as u,u as U,m as y,w as Y}from"./with-install-560d59bf.js";import{m as Z,e as Q,c as W,i as X}from"./use-translate-71d4880c.js";import{u as ee}from"./use-expose-80cfd2b2.js";import{u as oe}from"./use-lock-scroll-01f1fb06.js";import{u as ne}from"./use-lazy-render-e63df66f.js";import{P as te}from"./on-popup-reopen-6f4c2d78.js";import{u as ae,I as se}from"./index-1ef61aa2.js";import{O as le}from"./index-cd342d67.js";import{c as re}from"./interceptor-5424332a.js";import{H as ce}from"./constant-ee6e27d7.js";const x={show:Boolean,zIndex:O,overlay:u,duration:O,teleport:[String,Object],lockScroll:u,lazyRender:u,beforeClose:Function,overlayStyle:Object,overlayClass:U,transitionAppear:Boolean,closeOnClickOverlay:u},xe=Object.keys(x),ie=Q({},x,{round:Boolean,position:y("center"),closeIcon:y("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:y("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[ue,C]=W("popup"),de=L({name:ue,inheritAttrs:!1,props:ie,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:n,attrs:p,slots:l}){let a,r;const d=w(),c=w(),b=ne(()=>e.show||!e.lazyRender),S=R(()=>{const o={zIndex:d.value};if(X(e.duration)){const t=e.position==="center"?"animationDuration":"transitionDuration";o[t]=`${e.duration}s`}return o}),P=()=>{a||(a=!0,d.value=e.zIndex!==void 0?+e.zIndex:ae(),n("open"))},i=()=>{a&&re(e.beforeClose,{done(){a=!1,n("close"),n("update:show",!1)}})},A=o=>{n("clickOverlay",o),e.closeOnClickOverlay&&i()},I=()=>{if(e.overlay)return s(le,{show:e.show,class:e.overlayClass,zIndex:d.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0,onClick:A},{default:l["overlay-content"]})},B=o=>{n("clickCloseIcon",o),i()},T=()=>{if(e.closeable)return s(se,{role:"button",tabindex:0,name:e.closeIcon,class:[C("close-icon",e.closeIconPosition),ce],classPrefix:e.iconPrefix,onClick:B},null)};let f;const z=()=>{f&&clearTimeout(f),f=setTimeout(()=>{n("opened")})},g=()=>n("closed"),D=o=>n("keydown",o),E=b(()=>{var k;const{round:o,position:t,safeAreaInsetTop:m,safeAreaInsetBottom:v}=e;return $(s("div",J({ref:c,style:S.value,role:"dialog",tabindex:0,class:[C({round:o,[t]:t}),{"van-safe-area-top":m,"van-safe-area-bottom":v}],onKeydown:D},p),[(k=l.default)==null?void 0:k.call(l),T()]),[[q,e.show]])}),h=()=>{const{position:o,transition:t,transitionAppear:m}=e,v=o==="center"?"van-fade":`van-popup-slide-${o}`;return s(N,{name:t||v,appear:m,onAfterEnter:z,onAfterLeave:g},{default:E})};return K(()=>e.show,o=>{o&&!a&&(P(),p.tabindex===0&&j(()=>{var t;(t=c.value)==null||t.focus()})),!o&&a&&(a=!1,n("close"))}),ee({popupRef:c}),oe(c,()=>e.show&&e.lockScroll),Z("popstate",()=>{e.closeOnPopstate&&(i(),r=!1)}),F(()=>{e.show&&P()}),_(()=>{r&&(n("update:show",!0),r=!1)}),G(()=>{e.show&&e.teleport&&(i(),r=!0)}),V(te,()=>e.show),()=>e.teleport?s(H,{to:e.teleport},{default:()=>[I(),h()]}):s(M,null,[I(),h()])}}),fe=Y(de),be=fe;export{fe as P,be as V,xe as a,x as p};
